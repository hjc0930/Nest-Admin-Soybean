# éƒ¨ç½²è„šæœ¬ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½ç‰¹æ€§

- âœ… è‡ªåŠ¨æ‰“åŒ…å‰ç«¯é¡¹ç›®
- âœ… å‹ç¼©æ–‡ä»¶æé«˜ä¼ è¾“æ•ˆç‡
- âœ… è‡ªåŠ¨å¤‡ä»½æœåŠ¡å™¨ä¸Šçš„æ—§æ–‡ä»¶
- âœ… SSH ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
- âœ… æ”¯æŒå¯†ç å’Œç§é’¥ä¸¤ç§è®¤è¯æ–¹å¼
- âœ… æ”¯æŒå¤šç¯å¢ƒéƒ¨ç½²ï¼ˆdev/test/prodï¼‰
- âœ… å‹å¥½çš„å‘½ä»¤è¡Œæç¤ºå’Œè¿›åº¦æ˜¾ç¤º

## å®‰è£…ä¾èµ–

åœ¨å‰ç«¯é¡¹ç›®ç›®å½•æ‰§è¡Œï¼š

```bash
cd admin-naive-ui
pnpm install
```

## é…ç½®è¯´æ˜

ç¼–è¾‘ `deploy.config.cjs` æ–‡ä»¶ï¼Œé…ç½®ä½ çš„æœåŠ¡å™¨ä¿¡æ¯ï¼š

```javascript
module.exports = {
  dev: {
    name: 'å¼€å‘ç¯å¢ƒ',
    host: '192.168.1.100',        // æœåŠ¡å™¨åœ°å€
    port: 22,                      // SSH ç«¯å£
    username: 'root',              // SSH ç”¨æˆ·å
    password: 'your_password',     // SSH å¯†ç ï¼ˆä¸æ¨èï¼‰
    privateKey: '/path/to/key',    // ç§é’¥è·¯å¾„ï¼ˆæ¨èï¼‰
    passphrase: '',                // ç§é’¥å¯†ç ï¼ˆå¦‚æœæœ‰ï¼‰
    distPath: 'dist',              // æœ¬åœ°æ‰“åŒ…ç›®å½•
    remotePath: '/var/www/html/admin', // è¿œç¨‹éƒ¨ç½²ç›®å½•
    backupPath: '/var/www/backup/admin', // è¿œç¨‹å¤‡ä»½ç›®å½•
    isBackup: true,                // æ˜¯å¦å¤‡ä»½
  },
  // ... å…¶ä»–ç¯å¢ƒé…ç½®
};
```

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ | å¿…å¡« |
|--------|------|------|
| name | ç¯å¢ƒåç§° | æ˜¯ |
| host | æœåŠ¡å™¨åœ°å€ | æ˜¯ |
| port | SSH ç«¯å£ | æ˜¯ |
| username | SSH ç”¨æˆ·å | æ˜¯ |
| password | SSH å¯†ç  | äºŒé€‰ä¸€ |
| privateKey | SSH ç§é’¥è·¯å¾„ | äºŒé€‰ä¸€ |
| passphrase | ç§é’¥å¯†ç  | å¦ |
| distPath | æœ¬åœ°æ‰“åŒ…ç›®å½• | æ˜¯ |
| remotePath | è¿œç¨‹éƒ¨ç½²ç›®å½• | æ˜¯ |
| backupPath | è¿œç¨‹å¤‡ä»½ç›®å½• | æ˜¯ |
| isBackup | æ˜¯å¦å¤‡ä»½ | æ˜¯ |

### ä½¿ç”¨ç§é’¥è®¤è¯ï¼ˆæ¨èï¼‰

```javascript
{
  host: '192.168.1.100',
  port: 22,
  username: 'root',
  privateKey: '/Users/yourusername/.ssh/id_rsa', // Mac/Linux
  // privateKey: 'C:\\Users\\yourusername\\.ssh\\id_rsa', // Windows
  passphrase: '', // å¦‚æœç§é’¥æœ‰å¯†ç 
}
```

### ä½¿ç”¨å¯†ç è®¤è¯

```javascript
{
  host: '192.168.1.100',
  port: 22,
  username: 'root',
  password: 'your_password',
}
```

## ä½¿ç”¨æ–¹æ³•

### 1. ä½¿ç”¨ pnpm scriptsï¼ˆæ¨èï¼‰

```bash
# éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ
pnpm run deploy:dev

# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
pnpm run deploy:test

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
pnpm run deploy:prod
```

### 2. ç›´æ¥æ‰§è¡Œè„šæœ¬

```bash
# éƒ¨ç½²åˆ°å¼€å‘ç¯å¢ƒ
node deploy.js dev

# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
node deploy.js test

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
node deploy.js prod
```

## éƒ¨ç½²æµç¨‹

1. **æ‰“åŒ…å‰ç«¯é¡¹ç›®**ï¼šæ‰§è¡Œ `pnpm run build` æ‰“åŒ…å‰ç«¯ä»£ç 
2. **å‹ç¼©æ–‡ä»¶**ï¼šå°† dist ç›®å½•å‹ç¼©ä¸º tar.gz æ ¼å¼
3. **è¿æ¥æœåŠ¡å™¨**ï¼šé€šè¿‡ SSH è¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨
4. **å¤‡ä»½æ—§æ–‡ä»¶**ï¼šå¤‡ä»½æœåŠ¡å™¨ä¸Šçš„ç°æœ‰æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
5. **ä¸Šä¼ æ–‡ä»¶**ï¼šä¸Šä¼ å‹ç¼©åŒ…åˆ°æœåŠ¡å™¨
6. **éƒ¨ç½²æ–‡ä»¶**ï¼šè§£å‹æ–‡ä»¶åˆ°ç›®æ ‡ç›®å½•
7. **æ¸…ç†ä¸´æ—¶æ–‡ä»¶**ï¼šåˆ é™¤æœ¬åœ°å’Œè¿œç¨‹çš„ä¸´æ—¶å‹ç¼©åŒ…

## æœåŠ¡å™¨å‡†å¤‡

ç¡®ä¿æœåŠ¡å™¨ä¸Šçš„éƒ¨ç½²ç›®å½•æœ‰å†™å…¥æƒé™ï¼š

```bash
# SSH ç™»å½•åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# åˆ›å»ºéƒ¨ç½²ç›®å½•
mkdir -p /var/www/html/admin

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p /var/www/backup/admin

# è®¾ç½®æƒé™ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
chown -R www-data:www-data /var/www/html/admin
chmod -R 755 /var/www/html/admin
```

## å¸¸è§é—®é¢˜

### 1. è¿æ¥æœåŠ¡å™¨å¤±è´¥

- æ£€æŸ¥æœåŠ¡å™¨åœ°å€å’Œç«¯å£æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…è®¸ SSH è¿æ¥
- æ£€æŸ¥å¯†ç æˆ–ç§é’¥é…ç½®æ˜¯å¦æ­£ç¡®

### 2. æƒé™ä¸è¶³

- ç¡®ä¿ SSH ç”¨æˆ·æœ‰ç›®æ ‡ç›®å½•çš„å†™å…¥æƒé™
- å¯ä»¥ä½¿ç”¨ `sudo` æˆ–æ›´æ”¹ç›®å½•æ‰€æœ‰è€…

### 3. ç§é’¥è®¤è¯å¤±è´¥

- æ£€æŸ¥ç§é’¥è·¯å¾„æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç§é’¥æƒé™ï¼ˆåº”ä¸º 600ï¼‰ï¼š`chmod 600 ~/.ssh/id_rsa`
- å¦‚æœç§é’¥æœ‰å¯†ç ï¼Œç¡®ä¿é…ç½®äº† `passphrase`

### 4. æ‰“åŒ…å¤±è´¥

- æ£€æŸ¥ Node.js ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚
- ç¡®ä¿å·²å®‰è£…å‰ç«¯é¡¹ç›®ä¾èµ–ï¼š`cd admin-naive-ui && pnpm install`

## é…ç½® Nginxï¼ˆå¯é€‰ï¼‰

å¦‚æœä½¿ç”¨ Nginx ä½œä¸º Web æœåŠ¡å™¨ï¼Œå‚è€ƒé…ç½®ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    root /var/www/html/admin;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # API ä»£ç†
    location /api/ {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

## å®‰å…¨å»ºè®®

1. âš ï¸ **ä¸è¦å°† `deploy.config.cjs` æäº¤åˆ°ä»£ç ä»“åº“**ï¼Œå»ºè®®æ·»åŠ åˆ° `.gitignore`
2. ğŸ” ä¼˜å…ˆä½¿ç”¨ SSH ç§é’¥è®¤è¯ï¼Œé¿å…ä½¿ç”¨å¯†ç 
3. ğŸ”’ é™åˆ¶ SSH è®¿é—®ï¼Œåªå…è®¸ç‰¹å®š IP è¿æ¥
4. ğŸ’¾ å®šæœŸæ¸…ç†å¤‡ä»½ç›®å½•ï¼Œé¿å…å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´
5. ğŸ”‘ ä½¿ç”¨ä¸åŒçš„å¯†é’¥æˆ–å¯†ç ç®¡ç†å·¥å…·ç®¡ç†å¤šç¯å¢ƒé…ç½®

## è®¸å¯è¯

MIT
